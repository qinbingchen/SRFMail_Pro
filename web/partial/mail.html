<div class="mail-section" ng-controller="MailController">
    <div class="header">
        <div class="toolbar">
            <button ng-click="show_dispatch()" ng-show="current_user_type == 1"><i class="fa fa-reply fa-lg"></i>分发</button>
            <button ng-click="show_label()" ng-show="current_user_type == 1"><i class="fa fa-reply fa-lg"></i>主题标签</button>
            <button ng-click="check()" ng-show="current_user_type == 2"><i class="fa fa-check-circle-o fa-lg"></i>标记处理</button>
             <button ng-click="remind()" ng-disabled="selected_mail.isUrged" ng-show="current_user_type == 1 && selected_mail.status == 1">提醒</button>
            <button ng-click="show_compose()" ng-show="current_user_type == 2"><i class="fa fa-edit fa-lg"></i>撰写</button>
            <button ng-click="show_reply()" ng-disabled="selected_mail_id==''"
                    ng-show="current_user_type == 2  && !selected_mail.readonly"><i class="fa fa-edit fa-lg"></i>回复
            </button>
            <button ng-click="review_pass()" ng-disabled="selected_mail_id==''"
                    ng-show="current_user_type == 3 &&  selected_category.name == 'pending'"><i
                    class="fa fa-lg"></i>通过
            </button>
            <button ng-click="review_refuse()" ng-disabled="selected_mail_id==''"
                    ng-show="current_user_type == 3 && selected_category.name == 'pending'">
                <i class="fa fa-lg"></i>拒绝
            </button>
            <button ng-click="show_edit()" ng-disabled="selected_mail_id==''"
                    ng-show="current_user_type == 3 && selected_category.name == 'pending'"><i
                    class="fa fa-lg"></i>修改
            </button>
            <button ng-click="show_fw()" ng-disabled="selected_mail_id==''"
                    ng-show="current_user_type == 2 && !selected_mail.readonly && selected_category.name == 'pending'">
                <i class="fa fa-edit fa-lg"></i>转发
            </button>
            <button ng-click="worker_sendback()" ng-disabled="selected_mail_id=='' || work_sendback_flag"
                    ng-show="current_user_type == 2 && !selected_mail.readonly && selected_category.name == 'pending'">
                <i class="fa fa-edit fa-lg"></i>退回
            </button>
            <button class="right" ng-hide="current_user_type == -1" ng-click="logout()">登出</button>
            <span class="right">{{current_user_name}}</span>
        </div>
    </div>

    <div class="body">
        <div class="bubble" ng-show="fw_show">
            <div class="tri"></div>
            <div class="tri-inner"></div>
            <ng-include src="'partial/select-fw-worker.html'"></ng-include>
        </div>
        <div class="bubble" ng-show="dispatch_show">
            <div class="tri"></div>
            <div class="tri-inner"></div>
            <ng-include src="'partial/select-worker.html'"></ng-include>
        </div>
        <div class="bubble" ng-show="label_show">
            <div class="tri"></div>
            <div class="tri-inner"></div>
            <ng-include src="'partial/select-label.html'"></ng-include>
        </div>
        <div class="reject-bubble" ng-show="review_reject_show">
            <div class="tri"></div>
            <div class="tri-inner"></div>
            <div class="review-bubble">

                <label>拒绝意见</label>
                <br/>
                <textarea ng-model="review_comment_textarea"/>
                <br/>
                <button ng-click="review_refuse_cancel()" style="float: right;">取消</button>
                <button ng-click="review_refuse_confirm()" style="float: right;">确定</button>

            </div>
        </div>

        <div class="mail" ng-if="selected_mail_id != ''">
            <div class="info" ng-if="selected_mail.reply != null">
                <div class="title">{{selected_mail.reply.subject}}</div>
                <div class="time">{{selected_mail.reply.time}}</div>
                <div class="recipient">收件人 {{selected_mail.reply.to[0].name}} <{{selected_mail.reply.to[0].address}}></div>
            </div>
            <div class="info" ng-if="selected_mail.reply == null">
                <div class="title">{{selected_mail.income.subject}}</div>
                <div class="time">{{selected_mail.income.time}}</div>
                <div class="sender">发件人 {{selected_mail.income.from[0].name}} <{{selected_mail.income.from[0].address}}></div>
            </div>

            <div class="content" ng-bind-html="selected_mail.reply.html" ng-if="selected_mail.reply != null"></div>
            <div class="content" ng-bind-html="selected_mail.income.html" ng-if="selected_mail.reply == null"></div>

            <div class="original-income" ng-if="selected_mail.reply != null && selected_mail.income != null">
                <div class="title">主题：{{selected_mail.income.subject}}</div>
                <div class="time">时间：{{selected_mail.income.time}}</div>
                <div class="sender">发件人：{{selected_mail.income.from[0].name}} <{{selected_mail.income.from[0].address}}></div>
                <div class="content" ng-bind-html="selected_mail.income.html"></div>
            </div>
        </div>

        <div class="mail-empty" ng-if="selected_mail_id == ''">
            <i class="fa fa-envelope-o"></i>
            <div class="text">未选取邮件</div>
        </div>

        <div id="mail-operation-history"></div>

    </div>
</div>
